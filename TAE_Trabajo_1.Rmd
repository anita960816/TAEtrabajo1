---
title: "TAE Trabajo 1"
author: Camila Ospina Patino ; Ana Maria Vásquez Orrego ; Alejandra Valencia Palacio; Juan Esteban Restrepo Vélez; Jorge Mario Quintero Ocampo
date: "2/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preguntas sobre las dimensiones

> Demográfica:

- ¿De acuerdo a al promedio de habitantes por vivienda ver como se comportan en los diferentes estratos?
- ¿Observar en cúal de los estratos en más común que las personas planifiquen?

>Educación:

- ¿En qué estrato las personas presentan un mayor analfabetismo?
- ¿En que estratos las personas asistieron a universidades públicas y en que estratos asistieron a universidades privadas?
- ¿En que estratos las personas tienen una la percepción de que la educación ha presentado una mejora o sigue siento igual?

> Salud:

- ¿Hay facilidad de acceso al servicio de salud según el estrato?
- ¿Como se ve la afiliación a la seguridad social en los estratos?
- ¿Estado de salud según el estrato en el que se recide?
- ¿Calidad del servicio de salud según el estrato?

> Vivienda:

- ¿En que estrato se evidencia mayor cantidad de personas con vivienda propia?
- ¿Los apartamentos son en su mayoria lugares arrendados o propios?
- ¿En que estrato predomida el adobe revocado para la construccion de paredes?


>Trabajo:

- ¿Cuál es el medio de transporte que más utilizan las personas que desean cambiar de empleo?
- ¿Cuál es el rango de tiempo de desplazamiento a su lugar de trabajo que más emplean las personas que desean cambiar de empleo?
- ¿Cuál es la actividad que más realizan las personas que desean conseguir empleo?

## Cargar las librerias necesarias para el trabajo

```{r}
library(ggplot2)
library(tidyverse)
library(corrplot)
library(scales)
library(data.table)
library(rgdal)
library(leaflet)
library(htmlwidgets)
library(maptools)
```

Cargar la base de datos la cual se descargo desde http://medata.gov.co/dataset/encuesta-calidad-de-vida 

Al leer la base, pusimos los niveles -99, -98, -88 y -77 como si fueran NULL´s ya que hacen referencia a respuestas de las parsonas como no sabe, no responde o no aplica y como son respuestas que no nos dicen nada realmente significativo, las reunimos como una misma variable.

```{r}
ecv <- fread("encuesta_calidad_vida.csv",na=c(NULL,"-99","-98","-88","-77"), encoding = "UTF-8")

str_replace("encuesta_calidad.barrio", "ANDALUCIA", "ANDALUCÍA") %>%
str_replace("Nº 2", "NO.2") %>% 
str_replace("Nº 1", "NO.1") %>% 
str_replace("Nº 3", "NO.3") %>%
str_replace("AREA EXPANSION", "ÁREA DE EXPANSIÓN") %>%
str_replace("EXPANCION", "EXPANSIÓN") %>% 
str_replace("AREA", "ÁREA") %>% 
str_replace("BOMBONA", "BOMBONÁ") %>% 
str_replace("LA ASOMADERA", "ASOMADERA") %>%
str_replace("BELALCAZAR", "BELALCÁZAR") %>% 
str_replace("CALAZANS", "CALASANZ") %>% 
str_replace("COLON", "COLÓN") %>% 
str_replace("MIRA FLORES", "MIRAFLORES") %>% 
str_replace("BARRIO FACULTAD DE MINAS", "FACULTAD DE MINAS") %>% 
str_replace("CABECERA SAN ANT DE PR.", "SAN ANTONIO DE PRADO") %>% 
str_replace("CARLOS E RESTREPO", "CARLOS E. RESTREPO") %>% 
str_replace("URQUITA", "URQUITÁ") %>% 
str_replace("LOS CERROS EL VERJEL", "LOS CERROS EL VERGEL") %>% 
str_replace("CAYCEDO", "CAICEDO") %>% 
str_replace("VALDES", "VALDÉS") %>% 
str_replace("CERRO EL VOLADOR", "B. CERRO EL VOLADOR") %>% 
str_replace("MOSCU", "MOSCÚ") %>% 
str_replace("JOSELA", "JOSÉ LA") %>%
str_replace("JOSE", "JOSÉ") %>% 
str_replace("EL YOLOMBO", "YOLOMBO") %>% 
str_replace("PIEDRAS BLANCAS", "PIEDRAS BLANCAS - MATASANO") %>% 
str_replace("BASILIA", "BRASILIA") %>% 
str_replace("VILLA TINA", "VILLATINA") %>% 
str_replace("LILIAM", "LILLIAM") %>% 
str_replace("BOLIVAR", "BOLÍVAR") %>% 
str_replace("CORREGIMIENTO PALMITAS", "PALMITAS SECTOR CENTRAL") %>% 
str_replace("INES", "INÉS") %>% 
str_replace("FE", "FÉ") %>% 
str_replace("LUCIA", "LUCÍA") %>% 
str_replace("SABIO", "SAVIO") %>% 
str_replace("BERMEJAL- LOS ÁLAMOS", "BERMEJAL-LOS ÁLAMOS") %>% 
str_replace("BOLÍVARIANA", "BOLIVARIANA") %>% 
str_replace("EL NOGAL - LOS ALMENDROS", "EL NOGAL-LOS ALMENDROS") %>% 
str_replace("JUAN XXIII - LA QUIEBRA", "JUAN XXIII LA QUIEBRA") %>% 
str_replace("PROGRESO  Nº 2", "EL PROGRESO") %>% 
str_replace("MARIA", "MARÍA") %>% 
str_replace("PLAYÓN", "PLAYON") %>% 
str_replace("EL SOCORRO / LA GABRIELA", "EL SOCORRO") %>% 
str_replace("FÉRRINI", "FERRINI") %>% 
str_replace("LA CANDE LARIA", "LA CANDELARIA") %>%
str_replace("EL PLAYON", "PLAYÓN") %>%
str_replace("IGUANA", "IGUANÁ") %>%
str_replace("MARÍA CANO - CARAMBOLAS", "MARÍA CANO-CARAMBOLAS") %>%
str_replace("DE ABURRA", "DEL ABURRÁ") %>%
str_replace("ALTAVISTA CENTRAL", "ALTAVISTA SECTOR CENTRAL") %>%
str_replace("SECTOR CENTRAL", "CENTRO ADMINISTRATIVO") %>%
str_replace("ALTAVISTA CENTRO ADMINISTRATIVO", "ALTAVISTA SECTOR CENTRAL") %>%
str_replace("SANTA ELENA CENTRO ADMINISTRATIVO", "SANTA ELENA SECTOR CENTRAL") %>%
str_replace("PALMITAS CENTRO ADMINISTRATIVO", "PALMITAS SECTOR CENTRAL") %>%  
str_replace("PROGRESO", "EL PROGRESO")
```

Resumen de nuestra base de datos

```{r}
head(ecv)
dim(ecv)
glimpse(ecv)
```


# Preseleccion:

Las variables que van a formar parte de cada una de las dimensiones escogidas teniendo en cuenta el último año en que se realizo la encuesta, las cuales fueron: Demográfica, Educación, Trabajo, Vivienda y Salud

**Demográfica**

```{r}
Demo <- subset(ecv,encuesta_calidad.año == "2018",select = c("encuesta_calidad.barrio",
"encuesta_calidad.p_10","encuesta_calidad.p_12", "encuesta_calidad.p_15", "encuesta_calidad.p_18",
"encuesta_calidad.p_308","encuesta_calidad.p_23"))
```

**Educación**

```{r}
dimEdu <- subset(ecv, encuesta_calidad.año=="2018", select=c("encuesta_calidad.barrio", "encuesta_calidad.estrato", "encuesta_calidad.p_35", "encuesta_calidad.p_45", "encuesta_calidad.p_49", "encuesta_calidad.p_262"))
```

**Salud**

```{r}
dimSalud <- subset(ecv,encuesta_calidad.año == "2018",select = c(encuesta_calidad.barrio, encuesta_calidad.estrato, encuesta_calidad.p_15, encuesta_calidad.p_18, encuesta_calidad.p_57, encuesta_calidad.p_66, encuesta_calidad.p_265, encuesta_calidad.p_266, encuesta_calidad.p_342))
```

**Vivienda**

```{r}
dimVivienda <- subset(ecv,encuesta_calidad.año=="2018",select=c("encuesta_calidad.barrio",           "encuesta_calidad.estrato","encuesta_calidad.p_12","encuesta_calidad.p_146","encuesta_calidad.p_147",  "encuesta_calidad.p_148","encuesta_calidad.p_157","encuesta_calidad.p_158","encuesta_calidad.p_162", "encuesta_calidad.p_165","encuesta_calidad.p_174","encuesta_calidad.p_182","encuesta_calidad.p_226"))
```

**Trabajo**

```{r}
Tra <- subset(ecv,encuesta_calidad.año=="2018",select=c("encuesta_calidad.barrio","encuesta_calidad.p_69",  "encuesta_calidad.p_74","encuesta_calidad.p_75","encuesta_calidad.p_83", "encuesta_calidad.p_84","encuesta_calidad.p_100"))
```


Mirar como quedan las preselecciones

```{r}
glimpse(Demo)
glimpse(dimEdu)
glimpse(dimSalud)
glimpse(dimVivienda)
glimpse(Tra)
```


Promedios por vivienda con la función tapply() y  proporciones con la función prop.table()
Separamos los niveles de las variables que son cualitativas.

## Dimensión Demográfica:

P_10 : Estrato de las viviendas
Variable por niveles, así que los separamos

```{r}
Estrato <- table(Demo[,c("encuesta_calidad.barrio","encuesta_calidad.p_10")]) 
Estrato <- round(prop.table(Estrato),6)
```

Renombrar las columnas de la tabla

```{r}
colnames (Estrato) = c("Estrato_1", "Estrato_2", "Estrato_3", "Estrato_4", "Estrato_5", "Estrato_6")
```

P_12 : Personas que componen el hogar
Variable continua por lo que sólo le sacamos el promedio de habitantes por vivienda en los barrios.

```{r}
Habitantes <- round(tapply(Demo$encuesta_calidad.p_12, Demo$encuesta_calidad.barrio,  mean, na.rm= TRUE),6)
```

P_15 : Sexo
Se separa por niveles

```{r}
Sexo <- table(Demo[,c("encuesta_calidad.barrio","encuesta_calidad.p_15")]) 
Sexo <- round(prop.table(Sexo),6)
```

Renombrar las columnas que se generan

```{r}
colnames (Sexo) = c("Hombre","Mujer")
```

P_18 : Edad en años cumplidos
Edad al ser una variable continua no se hace por niveles, solo un promedio

```{r}
Edad <- round(tapply(Demo$encuesta_calidad.p_18, Demo$encuesta_calidad.barrio,  mean, na.rm= TRUE),6)
dim(Edad)
```

P_23 : Etnia
Se separa por niveles

```{r}
Etnia <- table(Demo[,c("encuesta_calidad.barrio","encuesta_calidad.p_23" )]) 
Etnia <- round(prop.table(Etnia),6)
```

Renombrar las columnas que se generan

```{r}
colnames (Etnia) = c( "Indigena", "Negro_Mulato", "Mestizo", "Blanco", "Raizal_Sanandresano","Rom_Gitano")
```


P_308 : Usted planifica

```{r}
Planificacion <- table(Demo[,c("encuesta_calidad.barrio","encuesta_calidad.p_308" )]) 
Planificacion <- round(prop.table(Planificacion),6)
```

Renombrar las columnas que se generan

```{r}
colnames (Planificacion) = c( "Si_Planifica", "No_Planifica")
```

**Matriz Demográfica**

Usando la función cbind() unificamos todas las columnas generadas en el anterior paso, así nuestra base de dimensión demográfica va quedar con clase matrix.

```{r}
DimDemo1 <- cbind(Estrato,Habitantes,Sexo,Edad,Etnia,Planificacion)
```

```{r}
dim(DimDemo1)
colnames(DimDemo1)
```

Como nuestra base tiene formato de matriz, sólo para hacer las gráficas descriptivas ponemos nuestra base como un data frame.

```{r}
DimDemo_1 <- as.data.frame(DimDemo1)
```

**Gráficas descriptivas**

Promedio de habitantes en las viviendas ~ Estratos

```{r}
GrDm1 <-table(Demo$encuesta_calidad.p_10)
barplot(GrDm1,Habitantes,  main = "¿Comó se distribuyen los habitantes encuestados según el estrato?",
        xlab = "Estratos", ylab = "Promedio Habitantes", ylim = c(0,15000),
        col = c(1:20))
legend(x = "topright", legend = c("Estrato 1", "Estrato 2","Estrato 3","Estrato 4",
                                  "Estrato 5", "Estrato 6"), fill = c(1:20), 
       title = "Estrato", cex = 0.6)
```
Es notorio en las gráficas que en los estratos 1, 2 y 3 hay un mayor número de habitantes por vivienda, mostrando que en promedio hay al menos mas de tres habitantes por vivienda y en los los estratos 1 y 2 como se ve que son en promedio mas de cuatro habitantes por vivienda en su mayoría. Mientras que en los estratos 4, 5 y 6 se evidencia que en promedio el número de habitantes por vivienda es menor que cuatro.


Sexo ~ Habitantes por vivienda

```{r}
GrDm2 <-table(Demo$encuesta_calidad.p_15, Demo$encuesta_calidad.p_10)
barplot(GrDm2, beside = T, main = "¿Comó se distribuyen los hombres y las mujeres en los diferentes estratos?",
        xlab = "Estratos", ylab = "Promedio Hombres y Mujeres", ylim = c(0,8000),
        col = c("red","lightblue"))
legend(x = "topright", legend = c("Hombre", "Mujer"), fill = c("red","lightblue"), 
       title = "Estrato", cex = 0.6)
```

Acá observamos el comportamiento de los hombres y las mujeres en los diferentes estratos y nos damos cuenta como fueron mas las mujeres entrevistadas que los hombres, pues sin importar el estrato en el que lo miremos, van a haber mas mujeres que hombres.

Estrato ~ Planificación

```{r}
GrDm3 <-table(Demo$encuesta_calidad.p_308, Demo$encuesta_calidad.p_10)
barplot(GrDm3, beside = T, main = "¿Qué tanto planifican las personas encuestadas?",
        xlab = "Estratos", ylab = "Frecuencia Planificación", ylim = c(0,5000),
        col = c("red","lightblue"))
legend(x = "topright", legend = c("Si", "No"), fill = c("red","lightblue"), 
       title = "Planifación", cex = 0.6)
```

Se ve como en proporciones y a grandes rasgos las personas de los estratos 1, 2 y 3 planifican más, por el contrario se ve como en pequeñas proporciones los estratos 4, 5 y 6 planifican menos.


Etnias

Realmente la gráfica nos muestra como en Medellín no hay un índice muy alto de habitantes pertenecientes a una etnia en particular y las únicas que podrían decir algo, son las etnias Blanco y Meztizo, que son las etnias a las que una mayor parte de la población pertenece, sin embargo las proporciones de pertenecia son muy bajas.


Edad ~ Sexo

Se ve como no hay ningún cambio entre la edad de las mujeres y los hombres que fueron encuestados y sin embargo aunque leve, hay un poco más de mujeres que estan entre los 30 y los 40 años.

## Dimensión Educación


```{r}
names(dimEdu)[1]<-"Barrio"
names(dimEdu)[2]<-"Estrato"
names(dimEdu)[3]<-"Sabe_leer_y_escribir"
names(dimEdu)[4]<-"Ultimo_nivel_de_estudio_aprobado"
names(dimEdu)[5]<-"Caracter_del_establecimiento_educativo"
names(dimEdu)[6]<-"Educacion_brindada_es"
```


Promedios y proporciones en las variables seleccionadas
Cambiando los nombres de las nuevas columnas que van a ser generadas en la separación de las variables que tienen niveles cualitativos.

Renombre de las variables de salida.

```{r}
dimEdu$Estrato <- factor(dimEdu$Estrato)
levels(dimEdu$Estrato) <- c("Estrato_1", "Estrato_2", "Estrato_3", "Estrato_4", "Estrato_5", "Estrato_6")

dimEdu$Sabe_leer_y_escribir <- factor(dimEdu$Sabe_leer_y_escribir)
levels(dimEdu$Sabe_leer_y_escribir) <- c("Sí", "No")


dimEdu$Ultimo_nivel_de_estudio_aprobado <- factor(dimEdu$Ultimo_nivel_de_estudio_aprobado)
levels(dimEdu$Ultimo_nivel_de_estudio_aprobado) <- c("Ninguno", "Salacuna","Primaria", "Secundaria","Media académica_o_Normalista", "Media_Técnica","Tecnológico", "Universidad","Especializacion", "Maestria","Doctorado")

dimEdu$Caracter_del_establecimiento_educativo <- factor(dimEdu$Caracter_del_establecimiento_educativo)
levels(dimEdu$Caracter_del_establecimiento_educativo) <- c("Público","Privado")

dimEdu$Educacion_brindada_es <- factor(dimEdu$Educacion_brindada_es)
levels(dimEdu$Educacion_brindada_es) <- c("Mejorado","Igual","Empeorado")
```

Proporción por Ultimo_nivel_de_estudio_aprobado
 
```{r}
nivel_estudio<-table(dimEdu[,c("Barrio","Ultimo_nivel_de_estudio_aprobado")])
nivel_estudio <- round(prop.table(nivel_estudio),6)
dim(nivel_estudio)
```

Proporción Sabe leer y escribir

```{r}
lee_escribe<-table(dimEdu[,c("Barrio","Sabe_leer_y_escribir")])
lee_escribe <- round(prop.table(lee_escribe),6)
dim(lee_escribe)
```

Proporción Caracter del establecimiento educativo

```{r}
estableccimiento_educativo<-table(dimEdu[,c("Barrio","Caracter_del_establecimiento_educativo")])
estableccimiento_educativo <- round(prop.table(estableccimiento_educativo),6)
dim(estableccimiento_educativo)
```

Proporción La educación brindada es igual, a mejorado o a empeorado

```{r}
educacion_brindada<-table(dimEdu[,c("Barrio","Educacion_brindada_es")])
educacion_brindada <- round(prop.table(educacion_brindada),6)
dim(educacion_brindada)
```

Estratos

```{r}
estrato <- table(dimEdu[,c("Barrio","Estrato")]) 
estrato <- round(prop.table(estrato),6)
dim(estrato)
```

**Matriz de la dimensión educación**

Con cbind(), la cual hace que nuestra base quede con clase matrix

```{r}
matEdu <- cbind(estrato, educacion_brindada, estableccimiento_educativo,lee_escribe,nivel_estudio)
dim(matEdu)
colnames(matEdu)
```

Sólo para hacer las gráficas descriptivas ponemos nuestra matriz como un data frame

```{r}
matrizEdu<- as.data.frame(matEdu)
colnames(matrizEdu)
```

**Gráficas descriptivas de la dimensión educación.**
En que estratos las personas asistieron a instituciones de educación públicas y en que estratos asistieron a instituciones de educación privadas
```{r}
Gra1 <- table(dimEdu$Caracter_del_establecimiento_educativo, dimEdu$Estrato)
Gra1
barplot(Gra1,  main = "¿Cuál es el caracter del establecimiento educativo?",beside = T,
        xlab = "Estratos", ylab = "Frecuencia", ylim = c(0,10000),
        col = c("red", "grey"))
        legend(x = "topright", legend = c("Público", "Privado"), fill = c("red", "grey"), 
        title = "Carácter del establecimiento educativo", cex = 0.7)
```
En Medellín las personas de los estratos 1 al 4 son las que más asisten a establecientos públicos, notandose una grand diferencia en cuanto a los que estudian en instituciones privadas, en cuanto a los estratos 5 y 6, en especial el 6, se nota como las personas asisten a más instituciones privadas. 

En qué estrato las personas presentan un mayor analfabetismo?
```{r}
Gra2 <- table(dimEdu$Sabe_leer_y_escribir,dimEdu$Estrato)
Gra2
barplot(Gra2,  main = "¿Sabe leer y escribir?",beside = T,
        xlab = "Estratos", ylab = "Frecuencia", ylim = c(0,12000),
        col = c("royalblue", "grey"))
        legend(x = "topright", legend = c("Si", "No"), fill = c("royalblue", "grey"), 
        title = "Lee y escribe", cex = 0.7)
```
Se ve claramente como el estrato 2, contiene un mayor número de personas que no sabe leer ni escribir. Por el contrario, las personas de estratos superiores al 4, presentan una disminución bastante considerable.

¿Cúal es el nivel de estudio más cpmún en los estratos más bajos?
```{r}
Gra3 <- table(dimEdu$Ultimo_nivel_de_estudio_aprobado,dimEdu$Estrato)
Gra3
barplot(Gra3,  main = "Ultimo nivel de estudio aprobado",beside = T,
        xlab = "Estratos", ylab = "Frecuencia", ylim = c(0,3500),
        col = c("darkblue", "grey", "orange", "blue", "yellow", "red", "purple", "brown", "green", "darkgrey", "black"))
        legend(x = "topright", legend = c("Ninguno", "Salacuna","Primaria", "Secundaria","Media académica_o_Normalista", "Media_Técnica","Tecnológico", "Universidad","Especializacion", "Maestria","Doctorado"), fill = c("darkblue", "grey", "orange", "blue", "yellow", "red", "purple", "brown", "green", "darkgrey", "black"), 
        title = "Nivel de estudio", cex = 0.7)
```
En los estratos 1, 2 y 3 se percibe como la mayor educación es primaria y media técnica, quedando no tener ningún tipo de estudio en tercer lugar con cifras bastantes grandes. En estrato 5 y 6 el nivel más alto es la universidad, seguido por la tecnología y la especialización.

En que estratos las personas tienen una la percepción de que la educación ha presentado una mejora o sigue siento igual?
```{r}
Gra4 <- table(dimEdu$Educacion_brindada_es,dimEdu$Estrato)
Gra4
barplot(Gra4,  main = "¿Cúal ha sido el cambio en la educación en los últimos 12 meses?",beside = T,
        xlab = "Estratos", ylab = "Frecuencia", ylim = c(0,5000),
        col = c("red", "yellow", "purple"))
        legend(x = "topright", legend = c("Mejorado", "Igual","Empeorado"), fill = c("red", "yellow", "purple"), 
        title = "Percepción", cex = 0.7)
```
Para las personas de estratos más bajos, como son el estrato 2 y 3 se tiene una percepción de que la educación ha mejorado y/o se ha mantenido igual, pero para las personas de más recursos (estratos 5 y 6) tienen una percepción diferente, llegando a percibir que la educación se ha mantenido igual.

## Dimensión Salud

Se hacen los cambios de clase necesarios en las variables originales

```{r}
dimSalud$estado_salud<- as.integer(dimSalud$estado_salud)
dimSalud$sindrome_down<- as.integer(dimSalud$sindrome_down)

glimpse(dimSalud)
```

Proporciones y Promedios por vivienda con la funcion tapply y prop.table
Separamos por niveles las que son variables discretas
```{r}
names(dimSalud)[1] <- "barrio"
names(dimSalud)[2] <- "estrato"
names(dimSalud)[3] <- "sexo"
names(dimSalud)[4] <- "edad"
names(dimSalud)[5] <- "sindrome_down"
names(dimSalud)[6] <- "afiliacion_seguridad_social"
names(dimSalud)[7] <- "facilidad_acceso_servicio_salud"
names(dimSalud)[8] <- "calidad_servicio_salud"
names(dimSalud)[9] <- "estado_salud"

```


```{r}
estrato <- table(dimSalud[,c("barrio","estrato")]) 
estrato <- round(prop.table(estrato),6)


sexo <- table(dimSalud[,c("barrio","sexo")]) 
sexo <- round(prop.table(sexo),6)


sindrome_down <- table(dimSalud[,c("barrio","sindrome_down")]) 
sindrome_down <- round(prop.table(sindrome_down),6)

afiliacion_seguridad_social <- table(dimSalud[,c("barrio","afiliacion_seguridad_social")]) 
afiliacion_seguridad_social <- round(prop.table(afiliacion_seguridad_social),6)

facilidad_acceso_servicio_salud <- table(dimSalud[,c("barrio","facilidad_acceso_servicio_salud")]) 
facilidad_acceso_servicio_salud <- round(prop.table(facilidad_acceso_servicio_salud),6)

calidad_servicio_salud <- table(dimSalud[,c("barrio","calidad_servicio_salud")]) 
calidad_servicio_salud <- round(prop.table(calidad_servicio_salud),6)

estado_salud <- table(dimSalud[,c("barrio","estado_salud")]) 
estado_salud <- round(prop.table(estado_salud),6)

```

Renombrar las columnas que se generan nuevas de las originales que se dividen en sus propias categorías.

```{r}
colnames (estrato) = c("Estrato_1", "Estrato_2", "Estrato_3", "Estrato_4", "Estrato_5", "Estrato_6")

colnames (sexo) = c("Masculino", "Femenino")

colnames (sindrome_down) = c("Sí", "No")

colnames (afiliacion_seguridad_social) = c("Tiene_EPS", "Beneficiario_EPS", "tiene_EPS_Subsidiada", "Régimen_especial", "Beneficiario_Régimen_especial", "SISBEN", "No_SISBEN")

colnames (facilidad_acceso_servicio_salud) = c("Muy_mala_facilidad", "Mala_facilidad", "Aceptable_facilidad", "Buena_facilidad", "Muy_buena_facilidad")

colnames (calidad_servicio_salud) = c("Muy_mala_calidad", "Mala_calidad", "Aceptable_calidad", "Buena_calidad", "Muy_buena_calidad")

colnames (estado_salud) = c("estado_salud_Malo", "estado_salud_Regular", "estado_salud_Bueno", "estado_salud_Excelente")
```

**Matriz de la dimensión salud**

Con la función cbind().

```{r}
dimSalud1 <- cbind(estrato,sexo, sindrome_down, afiliacion_seguridad_social, facilidad_acceso_servicio_salud, calidad_servicio_salud, estado_salud)
```

Para hacer nuestras gráficas descriptivas ponemos nuestra base de dimensión como un data frame.

```{r}
dimSalud1 <- as.data.frame(dimSalud1)
```

**Gráficas descriptivas Salud**
Facilidad de acceso al servicio de salud
```{r}
GrDmX <-table(dimSalud$facilidad_acceso_servicio_salud, dimSalud$estrato )
barplot(GrDmX, beside = T, main = "¿Cúal es la facilidad de acceso a los servicios de salud?", xlab = "Estratos", ylab = "Frecuencia", col = c("lightgreen","lightblue","lightyellow","orange","brown")) 
legend(x = "topright", legend = c("Muy mala", "Mala","Aceptable","Buena","Muy buena"), fill = c("lightgreen","lightblue","lightyellow","orange","brown"), title = "Percepción", cex = 0.6)

```
Las personas en Medellín perciben una facilidad de acceso buena y aceptable a los servicios de salud, se puede apreciar en en todos los estratos, que se sigue el mismo patrón, siendo mayormente percibido como buena y aceptable, sedgudio por mala  o aceptable.


Afiliacion seguridad social
```{r}
GrDmY <-table(dimSalud$afiliacion_seguridad_social, dimSalud$estrato )
barplot(GrDmY, beside = T, main = "¿Cúal es la tipo de afiliación al sistema de seguridad social?", xlab = "Estratos", ylab = "Frecuencia", col = c("lightgreen","lightblue","lightyellow","orange","brown","yellow","blue")) 
  legend(x = "topright", legend = c("Tiene_EPS","Beneficiario_EPS","tiene_EPS_Subsidiada","Régimen_especial","Beneficiario_Régimen_especial","SISBEN","No_SISBEN"), fill = c("lightgreen","lightblue","lightyellow","orange","brown","yellow","blue"), title = "Tipos de afiliación", cex = 0.6)
```
Se aprecia como las personas en Medellín que pertenecen al estrato 2 y superiores, tienen en su mayoría EPS o son beneficiarios de EPS, mientras que en el estrato 1 se nota como la mayoria pertenecen al regimen de EPS subsidiada.

Estado de salud
```{r}
GrDmZ <-table(dimSalud$estado_salud, dimSalud$estrato )
barplot(GrDmZ, beside = T, main = "¿Cúal es generalmente el estado de salud?", xlab = "Estratos", ylab = "Frecuencia", col = c("lightgreen","lightblue","lightyellow","orange")) 
legend(x = "topright", legend = c("Malo","Regular","Bueno","Excelente"), fill = c("lightgreen","lightblue","lightyellow","orange"), title = "Percepción", cex = 0.6)
```
Las personas en Medellín sin importara que estrato social pertenecen, tienen una percepción de su estado de salud bueno y excelente. En cuanto a las personas que reportaron tener un estado de salud malo, pertenecen en su mayoría los estratos 1, 2 y 3


Calidad del servicio de salud
```{r}
GrDmXX <-table(dimSalud$calidad_servicio_salud, dimSalud$estrato )
barplot(GrDmXX, beside = T, main = "¿Cúal es la calidad de los servicios de salud?", xlab = "Estratos", ylab = "Frecuencia", col = c("lightgreen","lightblue","lightyellow","orange","brown")) 
legend(x = "topright", legend = c("Muy mala", "Mala","Aceptable","Buena","Muy buena"), fill = c("lightgreen","lightblue","lightyellow","orange","brown"), title = "Percepción", cex = 0.6)
```
Según la percepción de las personas en Medellín, la calidad de los servicios de salud es buena, seguida por aceptable, es interesante ver como las proporciones en las respuestas se mantienen proporcionales sin importar el restrato.0


## Dimension Vivienda

Renombrar las columnas

```{r}
names(dimVivienda)
names(dimVivienda)[1] <- "Barrio"
names(dimVivienda)[2] <- "Estrato"
names(dimVivienda)[3] <- "cantidad_personas_hogar"
names(dimVivienda)[4] <- "tipo_vivienda"
names(dimVivienda)[5] <- "material_paredes_externas"
names(dimVivienda)[6] <- "material_pisos"
names(dimVivienda)[7] <- "numero_cuartos"
names(dimVivienda)[8] <- "tiene_energia"
names(dimVivienda)[9] <- "tiene_acueducto"
names(dimVivienda)[10] <- "tiene_alcantarillado"
names(dimVivienda)[11] <- "tiene_aseo(recoleccion)"
names(dimVivienda)[12] <- "afectada_desastres"
names(dimVivienda)[13] <- "hogar_arrendado_o_pago"
```

Proporciones con prop.table y Promedios con la funcion tapply
Y renombrar las calomnas nuevas que se crean de los niveles

Estrato

```{r}
Estrato <- table(dimVivienda[,c("Barrio","Estrato")]) 
Estrato <- round(prop.table(Estrato),6)
colnames (Estrato) = c("Estrato_1", "Estrato_2", "Estrato_3", "Estrato_4", "Estrato_5", "Estrato_6")
```

Cantidad de Personas por vivienda

```{r}
cantidad_personas_hogar <-  round(tapply(dimVivienda$cantidad_personas_hogar, dimVivienda$Barrio,  mean, na.rm= TRUE),6)
```

Hogares afectados por desastres

```{r}
afectada_desastres <- table(dimVivienda[,c("Barrio","afectada_desastres")])
afectada_desastres <- round(prop.table(afectada_desastres),6)
colnames (afectada_desastres) = c("Ninguno", "Inundaciones", "Avalancha", "Deslizamiento", "Hundimiento de terreno", "Falla geologica","Incendios")
```

Material de Paredes Exernas

```{r}
material_paredes_externas <- table(dimVivienda[,c("Barrio","material_paredes_externas")])
material_paredes_externas <- round(prop.table(material_paredes_externas),6)
colnames (material_paredes_externas) = c("Materiales_desechos", "Madera_burda1", "Bahareque_sin_revocar", "Bahareque_revocado", "Tapia_pisada",  "Material_prefabricado", "adobe_sin_ranurar", "Bloque_ranurado", "Ladrillo_ranurado","adobe_revocado","bloque_forrado_en_piedra")
```

Material de Pisos

```{r}
material_pisos <- table(dimVivienda[,c("Barrio","material_pisos")])
material_pisos <- round(prop.table(material_pisos),6)
colnames (material_pisos) = c("Tierra", "Madera_burda", "Cemento", "Baldosa", "Marmol",  "Madera_pulida", "alfonbra")
```

La vivienda tiene energia

```{r}
tiene_energia <- table(dimVivienda[,c("Barrio","tiene_energia")])
tiene_energia <- round(prop.table(tiene_energia),6)
colnames(tiene_energia) = c("si_tiene_energia")
```

La vivienda tiene acueducto

```{r}
tiene_acueducto <- table(dimVivienda[,c("Barrio","tiene_acueducto")])
tiene_acueducto <- round(prop.table(tiene_acueducto),6)
colnames(tiene_acueducto) = c("si_tiene_acueducto","no_tiene_acueducto")

```

La vivienda tiene alcantarillado

```{r}
tiene_alcantarillado <- table(dimVivienda[,c("Barrio","tiene_alcantarillado")])
tiene_tiene_alcantarilladoacueducto <- round(prop.table(tiene_alcantarillado),6)
colnames(tiene_alcantarillado) = c("si_tiene_alcantarillado","no_tiene_alcantarillado")
```

Tipo de vivienda ( Tipo de casa )

```{r}
tipo_vivienda <- table(dimVivienda[,c("Barrio","tipo_vivienda")])
tipo_vivienda <- round(prop.table(tipo_vivienda),6)
colnames(tipo_vivienda) = c("tipo_rancho","tipo_cuarto","tipo_inquilinato","tipo_apartamento","tipo_casa")
```

Tipo de vivienda ( Arrendado o Propio)

```{r}
hogar_arrendado_o_pago <- table(dimVivienda[,c("Barrio","hogar_arrendado_o_pago")])
hogar_arrendado_o_pago <- round(prop.table(hogar_arrendado_o_pago),6)
colnames(hogar_arrendado_o_pago) = c("En_arriendo","Propia_pagando","Propia_pagada","Usufructo","Ocaupantes","Anticresis")
```

**Matriz Dimensión Vivienda**

```{r}
matrizVivienda <- cbind(Estrato,cantidad_personas_hogar,afectada_desastres,material_paredes_externas,material_pisos,tiene_energia,tiene_acueducto,tipo_vivienda,tiene_alcantarillado,hogar_arrendado_o_pago)
dim(matrizVivienda)
```

Sólo para hacer las gráficas ponemos la matriz como un data frame

```{r}
matrizVivienda<-as.data.frame(matrizVivienda)
```

**Gráficas Descriptivas dimensión Vivienda**


```{r}
GrDm3 <-table(dimVivienda$hogar_arrendado_o_pago, dimVivienda$Estrato)
barplot(GrDm3, beside = T, main = "¿Qué cantidad de personas encuestada tiene casa propia?",
        xlab = "Estratos", ylab = "Frecuencia Planificación", ylim = c(0,10000),
        col = c("blue","green","yellow","orange","brown","pink"))
legend(x = "topright", legend = c("En_arriendo","Propia pagando","Propia pagada","Usufructo","Ocaupantes","Anticresis"), fill = c("blue","green","yellow","orange","brown","pink"), 
       title = "Tipo de casa", cex = 0.6)
```
Las personas de estrato 2 y 3 son las que evidencian un mayor número de personas con vivienda propia.



Cantidad Personas Hogar ~ Tipo vivienda
```{r}
GrDm3 <-table(dimVivienda$tipo_vivienda, dimVivienda$Estrato)
barplot(GrDm3, beside = T, main = "¿Qué tipo de vivienda tienen las personas encuestadas?",
        xlab = "Estratos", ylab = "Frecuencia Planificación", ylim = c(0,10000),
        col = c("blue","green","yellow","orange","brown"))
legend(x = "topright", legend = c("Rancho","Cuarto","Inquilinato","Apartamento","Casa"), fill = c("blue","green","yellow","orange","brown"), 
       title = "Tipo de casa", cex = 0.6)
```
La mayor cantidad de casas se encuentra en hogares de estratos bajos, mientras mas alto el estrato se nota una preferencia por los apartamentos.

Cantidad Personas Hogar ~ Tipo de material de paredes
```{r}
GrDm3 <-table(dimVivienda$material_paredes_externas, dimVivienda$Estrato)
barplot(GrDm3, beside = T, main = "¿Materia de paredes de hogares encuestados?",
        xlab = "Estratos", ylab = "Frecuencia Planificación", ylim = c(0,10000),
        col = c("blue","green","yellow","orange","brown","purple","pink","magenta","violet","lightblue","lightgreen"))
legend(x = "topright", legend = c("Materiales de desechos", "Madera burda", "Bahareque sin revocar", "Bahareque revocado", "Tapia pisada",  "Material prefabricado", "adobe sin ranurar", "Bloque ranurado", "Ladrillo ranurado","adobe revocado","bloque forrado en piedra"), fill = c("blue","green","yellow","orange","brown","purple","pink","magenta","violet","lightblue","lightgreen"), 
       title = "Material de paredes", cex = 0.6)
```
Las personas de estrato 2 y 3 son las personas encuestadas que tienen mayor cantidad de viviendas revocadas.


```{r}
GrDm3 <-table(dimVivienda$material_pisos, dimVivienda$Estrato)
barplot(GrDm3, beside = T, main = "¿Material del piso de personas encuestadas?",
        xlab = "Estratos", ylab = "Frecuencia Planificación", ylim = c(0,10000),
        col = c("blue","green","yellow","orange","brown","purple","pink"))
legend(x = "topright", legend = c("Tierra", "Madera_burda", "Cemento", "Baldosa", "Marmol",  "Madera_pulida", "alfonbra"), fill = c("blue","green","yellow","orange","brown","purple","pink"), 
       title = "Material de pisos", cex = 0.6)
```
El material de piso predominante incluso en estratos bajos es el tipo baldosa.





## Dimensión Trabajo

Organizar la clase de las variables

```{r}
Tra$encuesta_calidad.p_69<- as.integer(Tra$encuesta_calidad.p_69)
Tra$encuesta_calidad.p_74<- as.integer(Tra$encuesta_calidad.p_74)
Tra$encuesta_calidad.p_75<- as.integer(Tra$encuesta_calidad.p_75)
Tra$encuesta_calidad.p_83<- as.integer(Tra$encuesta_calidad.p_83)
Tra$encuesta_calidad.p_84<- as.integer(Tra$encuesta_calidad.p_84)
Tra$encuesta_calidad.p_100<- as.integer(Tra$encuesta_calidad.p_100)
```

Proporciones por barrio con la funcion prop.table y promedios con la función tapply.
Y cambio de nombres de las columnas que se generan.

P_69 : Actividad que realiza la mayor parte del tiempo

```{r}
 
Ocupa1 <- round(table(Tra[, c("encuesta_calidad.barrio", "encuesta_calidad.p_69")]),6) 
Ocupa_pro <- round(prop.table(Ocupa1),6) 
colnames(Ocupa_pro) = c("Trabajando","Buscando_Trabajo","Estudiando","Oficios_del_Hogar","Rentista",
                        "Jubilado_Pensionado","Otra_Actividad","Incapacitado_permanente")
```

P_74 : ¿Desea conseguir empleo o instalar un negocio? 

```{r}
Emple1 <- round(table(Tra[, c("encuesta_calidad.barrio", "encuesta_calidad.p_74")]),6) 
Emple_pro <- round(prop.table(Emple1),6) 
colnames(Emple_pro) = c("Si","No")
```

P_75 : Motivo por el cual no ha conseguido trabajo

```{r}
NoTra1 <- round(table(Tra[, c("encuesta_calidad.barrio", "encuesta_calidad.p_75")]),6) 
NoTra_pro <- round(prop.table(NoTra1),6)
colnames(NoTra_pro) = c("Ya_Encontró_Trabajo","No_Disponibilidad_Ciudad","Esperando_Llamada","No_Sabe_Buscar","Cansado_Buscar","No_Encuentra_Profesión","Esperando_TemporadaAlta","Carece_Experiencia","No_Recursos_Negocio","Empleadores_Joven_Viejo","Usted_Joven_Viejo","Responsabilidades",
                        "Problemas_Salud","Estudiando","ServicioMilitar_Policía","Planeando_Viaje","Labores_Hogar","Violencia")
```

P_83 : Medio de transporte para desplazarse hasta su lugar de trabajo

```{r}
Trans1 <- round(table(Tra[, c("encuesta_calidad.barrio", "encuesta_calidad.p_83")]),6) 
Trans_pro <- round(prop.table(Trans1),6)
colnames(Trans_pro) = c("Caminando","Bicicleta","Moto","Bus/Buseta/Ejecutivo","Transporte_Informal","Taxi/Colectivo","Transporte_Particular",
                        "Metro_Cable","SIT","Aéreo")
```

P_84 : Tiempo que emplea para desplazarse hasta su lugar de trabajo

```{r}
Tiem1 <- round(table(Tra[, c("encuesta_calidad.barrio", "encuesta_calidad.p_84")]),6) 
Tiem_pro <- round(prop.table(Tiem1),6) 
colnames(Tiem_pro) = c("0-20","21-40","41-60","61-80",">80")
```

P_100 : ¿Desea cambiar de trabajo?

```{r}
Cam1 <- round(table(Tra[, c("encuesta_calidad.barrio", "encuesta_calidad.p_100")]),6) 
Cam_pro <- round(prop.table(Cam1),6) 
colnames(Cam_pro) = c("Si","No")
```

**Matriz Dimensión Trabajo**

```{r}
DimTra1 <- cbind(Ocupa_pro,Emple_pro,NoTra_pro,Trans_pro,Tiem_pro,Cam_pro)

dim(DimTra1)
```

Para hacer las gráficas ponemos la base como un data frame

```{r}
DimTra_2 <- as.data.frame(DimTra1)
```

**Graficas descriptivas dimensión Trabajo**

Conseguir empleo ~ Ocupación

```{r}
Gra1 <- table(Tra$encuesta_calidad.p_74,Tra$encuesta_calidad.p_69)
Gra1
barplot(Gra1,  main = "¿Cuál es la actividad que más realizan las 
        personas que desean conseguir empleo?",
        xlab = "Ocupación", ylab = "Frecuencia", ylim = c(0,6000),
        col = c("royalblue", "grey"))
        legend(x = "topright", legend = c("Si", "No"), fill = c("royalblue", "grey"), 
        title = "¿Desea conseguir empleo?", cex = 0.7)
```
Se puede observar que las ocupaciones de las personas que tienen mayor deseo de conseguir trabajo o instalar su propio negocio son aquellas en su mayor parte del tiempo se dedican a buscar empleo. Al contrario de los estudiantes, rentistas, jubilados, personas que se dedican a los oficios del hogar y realizan otro tipo de actividad, que en su mayoria no desean ubicarse laboralmente. No se observan personas incapacitadas permanentemente para laborar en la encuesta.

Tiempo de desplazamiento ~ Deseo cambiar empleo

```{r}
Gra2 <- table(Tra$encuesta_calidad.p_100,Tra$encuesta_calidad.p_84)
Gra2
barplot(Gra2,  main = "¿Cuál es el rango de tiempo de desplazamiento a su lugar
        de trabajo que más emplean las personas que desean cambiar de empleo?",
        xlab = "Tiempo de desplazamiento", ylab = "Frecuencia", ylim = c(0,5500),
        col = c("royalblue", "grey"))
        legend(x = "topright", legend = c("Si", "No"), fill = c("royalblue", "grey"), 
        title = "¿Desea cambiar de empleo?", cex = 0.7)
```
Se observa que los rangos de tiempo de desplazamiento a su lugar de trabajo que más emplean las personas que desean cambiar de trabajo son entre (0,21] y (21,40] minutos. En cada uno de los rangos de tiempo son más las personas que no desean cambiar de trabajo con respecto a las que si.


Medio transporte ~ Deseo cambiar empleo

```{r}
Gra3 <- table(Tra$encuesta_calidad.p_100,Tra$encuesta_calidad.p_83)
Gra3
barplot(Gra3,  main = "¿Cuál es el medio de transporte que más utilizan
        las personas que desean cambiar de empleo?",
        xlab = "Medio de transporte", ylab = "Frecuencia", ylim = c(0,4000),
        col = c("royalblue", "grey"))
        legend(x = "topright", legend = c("Si", "No"), fill = c("royalblue", "grey"), 
        title = "¿Desea cambiar de empleo?", cex = 0.7)
```
En el diagrama podemos observar que los medios de transporte que más utilizan las personas que desean cambiar de trabajo son aquellas que se desplazan a su lugar de trabajo caminando o en bus. En cada uno de los medios de transporte se observa mayor frecuencia de las personas que no desean cambiar de trabajo con respecto a las que si. No hay personas que se desplacen en un medio de transporte aéreo que deseen cambiar de empleo.


# Agrupamiento

## Agrupamiento Dimensión Demográfica

Dendograma Agnes

```{r}
DimDemo2<- scale(DimDemo1)
```

```{r}
library(cluster)
library(purrr)
```

Método Ward

```{r}

m <- c( "average", "single", "complete", "ward") # vector of methods to compare
names(m) <- c( "average", "single", "complete", "ward")

ac <- function(x) { # function to compute coefficient
  agnes(DimDemo2, method = x)$ac
}
map_dbl(m, ac)

hc3 <- agnes(DimDemo2, method = "ward")
pltree(hc3, cex = 0.3, hang = -1, main = "Dendrogram of agnes")
clust <- cutree(hc3, k = 4)
rect.hclust(hc3, k = 4, border = 2:10)
```

En estos tres grupos queda mucho mas claro, la importancia de cada uno de los barrios de Medellín según la dimensión demográfica


## Agrupamiento Dimensión Educación

```{r}
matrizEduNor<- scale(matrizEdu)
```

```{r}
#Completo
library(cluster)
library(purrr)

#Agnes
hc2 <- agnes(matrizEduNor, method = "complete")
hc2$ac # Agglomerative coefficient

m <- c( "average", "single", "complete", "ward") # vector of methods to compare
names(m) <- c( "average", "single", "complete", "ward")

ac <- function(x) { # function to compute coefficient
  agnes(matrizEduNor, method = x)$ac
}
map_dbl(m, ac)
library (stats)
hc3 <- agnes(matrizEduNor, method = "ward")
pltree(hc3, cex = 0.3, hang = -1, main = "Dendrogram of agnes")
clust <- cutree(hc3, k = 2)
rect.hclust(hc3, k = 4, border = 2:10)
```

Se realiza el agrupamiento jerarquico, Dendograma, dada línea vertical del diagrama representa un agrupamiento que coincide con los puntos arropados por ésta, y como se ve en el dendrograma, estos van formándose progresivamente hasta tener un solo gran grupo determinado por la línea horizontal superior. Una manera de determinar entonces la cantidad de clases adecuadas es cortando el dendrograma a aquella altura del diagrama que mejor representa los datos de entrada.



## Agrupamiento Dimensión salud

Escalar y centrar la base
```{r}
dimSalud1Normalizada<- scale(dimSalud1)
#SaludMeanNormalizada
```


Agrupamiento Jerarquico Agnes, Dendograma


```{r}
library(cluster)
library(purrr)

#Agnes
hc2 <- agnes(dimSalud1Normalizada, method = "complete")
hc2$ac # Agglomerative coefficient

m <- c( "average", "single", "complete", "ward") # vector of methods to compare
names(m) <- c( "average", "single", "complete", "ward")

ac <- function(x) { # function to compute coefficient
  agnes(dimSalud1Normalizada, method = x)$ac
}
map_dbl(m, ac)

hc3 <- agnes(dimSalud1Normalizada, method = "ward")
pltree(hc3, cex = 0.3, hang = -1, main = "Dendrogram of agnes")
clust <- cutree(hc3, k = 2)
rect.hclust(hc3, k = 4, border = 2:10)

```

## Agrupamiento Dimensión Vivienda

Agrupamiento Jerárquico, un dendograma.

```{r}
dimViNormalizada<- scale(matrizVivienda)
```

```{r}
library(cluster)
library(purrr)

#Agnes
hc2 <- agnes(dimViNormalizada, method = "complete")
hc2$ac # Agglomerative coefficient

m <- c( "average", "single", "complete", "ward") # vector of methods to compare
names(m) <- c( "average", "single", "complete", "ward")

ac <- function(x) { # function to compute coefficient
  agnes(dimViNormalizada, method = x)$ac
}
map_dbl(m, ac)

hc3 <- agnes(dimViNormalizada, method = "ward")
pltree(hc3, cex = 0.3, hang = -1, main = "Dendrogram of agnes")
clust <- cutree(hc3, k = 4)
rect.hclust(hc3, k = 4, border = 2:10)

```

## Agrupamiento Dimensión Trabajo

Escalar y centrar la base 
```{r}
DimTra2<- scale(DimTra1)
```

Agrupamiento Jerarquico, Dendograma

Agrupamiento utilizando el Método Agnes
```{r}
library(cluster)
library(purrr)

m <- c( "average", "single", "complete", "ward")
names(m) <- c( "average", "single", "complete", "ward")

ac <- function(x) { 
  agnes(DimTra2, method = x)$ac
}
map_dbl(m, ac)

hc3 <- agnes(DimTra2, method = "ward")
pltree(hc3, cex = 0.3, hang = -1, main = "Dendrogram of agnes")
clust <- cutree(hc3, k = 2)
rect.hclust(hc3, k = 4, border = 2:10)
```

## Mapas

Leer Archivo que contiene informacion geografica de los barrios y veredas de Medellín 
```{r}
barrios_med <- readOGR (dsn="Barrio_Vereda.shp",layer="Barrio_Vereda", encoding = "UTF-8")
nombres_barrios <- iconv(barrios_med@data$NOMBRE,"UTF-8","ISO_8859-1")

#Mapa simple
m=leaflet(barrios_med)
m=addTiles(m)
m

#Superoponemos los barrios

m=addPolygons(m,popup=nombres_barrios)
m=addTiles(m)
m

#Color a los barrios
colores=sample(x=c("orange","green","yellow"),size=length(nombres_barrios),replace=TRUE)
m=addPolygons(m,popup=nombres_barrios,color=colores)
m
```

## Conclusiones

Es curioso ver como en los estratos bajos, 1, 2 y 3 es donde se presenta una mayor proporción de personas que planifican y como en las estratos altos, 4, 5 y 6 tienen menos proporción en la planificación. También es muy interesante ver como justamente es en los estratos 1, 2 y 3 donde se presenta un mayor promedio de habitantes por vivienda, es extraño que justamente esos estratos sean los que tengan mas habitantes por vivienda, pero es así como nos muestra la encuesta que va la situación de la ciudad de Medellín y sus habitantes. Hemos de resaltar que es muy notoria la falta de personas que pertenezcana una etnia o que sepan que pertenecen a una, pues las únicas que tenían datos a resaltar, pero sin ser los más aportantes, son las etnias blanco y mestizo.


Las personas de escasos recursos, es decir, las que pertenecen a los más bajos estratos (1,2,3), son las que presentan un mayor analfabetismo, siendo este en mayor grado en las personas de estrato 2. Estas mismas comunidades presentan una menor cantidad de personas que realizaron sus estudios superiores (posgrado) y que cuentan con el título de magister o doctor. La percepción en la educación también se ve involucrada en estos aspectos, pero las personas de estratos más altos muestran un nivel de exigencia mayor, considerando que la educación no ha presentado mejora y que sigue igual, pero las personas de estratos mas bajos consideran que el nivel de educación en sus barrios ha mejorado.


 La percepción del estado de salud y de la calidad del servicio de salud se ve variado en los diferentes estatos de las personas encuestadas. Las personas que manifiestan tener un buen estado de salud se ve aumentado en mayor medida en los estratos medios. Algo similar sucede con la calidad del servicio de salud, siendo las personas de estrato 1 y 2 las que dicen tener una percepción de la calidad del servicio de salud aceptable y las de estrato 3 una percepción de un servicio de buena calidad. 


 La mayor parte de viviendas propias las tienen las personas de estratos 2, además el mayor numero de personas por hogar esta en los estratos 2 y 3, teniendo así hogares muy poblados en los lugares mas pobres, tambien se evidencia que la mayoria de hogares que son tipo apartamento son viviendas propias.El material predominante en la construccion de las viviendas para todos los estratos es el adobe revocado, y a nivel de piso inlcuso en estratos inferiores hacen uso de Baldosa como material predominante.


Las variables escogidas para explicar el comportamiento de las personas con respecto a su condición de empleo o desempleo, nos muestran que es más el deseo de permanecer en su trabajo actual que buscar nuevas ofertas laborales, debido a la falta de oportunidades y a la alta demanda de empleo.


Analizando cúal de los métodos es más eficiente para realizar el dendograma, podemos observar que el méthodo "ward" permite una mejor interpretabilidad de los datos.


## Referencias

https://bookdown.org/jboscomendoza/r-principiantes4/data-frames.html

https://rstudio.github.io/leaflet/map_widget.html

https://www.datanalytics.com/libro_r/ejemplos-1.html

http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/

https://rpubs.com/daniballari/ggplot

https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/rect.hclust

https://rpubs.com/mjimcua/clustering-jerarquico-en-r

https://rpubs.com/kfhidalgoh/300948
